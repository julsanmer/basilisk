

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Making Python Modules &mdash; Basilisk 2.2.1b0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Module RST Documentation" href="makingModules-3.html" />
    <link rel="prev" title="C++ Module with C-Wrapped Output Message" href="cppModules/cppModules-5.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #CFB87C" >
          

          
            <a href="../../index.html" class="icon icon-home"> Basilisk
          

          
            
            <img src="../../_static/Basilisk-Logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                version 2.2.1b0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Basilisk:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Install.html">Install</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../Learn.html">Learning Basilisk</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bskPrinciples.html">Fundamentals of Basilisk Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html">Integrated Example Scripts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../makingModules.html">Basics of Writing Basilisk Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="makingModules-1.html">Module Design Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="makingModules-2.html">Creating New Message Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="cModules.html">Making C Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="cppModules.html">Making C++ Modules</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Making Python Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#deprecated-way-of-creating-python-modules">Deprecated way of creating Python modules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="makingModules-3.html">Module RST Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="makingModules-4.html">Module Unit Test File</a></li>
<li class="toctree-l3"><a class="reference internal" href="makingDraftModule.html">Automation Script to Create a New Basilisk Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="makingModules-5.html">Common Basilisk Support Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="advancedTopics.html">Advanced Topics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Documentation/index.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Forum.html">News and Discussions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vizard:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Vizard/Vizard.html">About Vizard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Vizard/VizardDownload.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Vizard/VizardReleaseNotes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Vizard/VizardGUI.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Vizard/vizardAdvanced/index.html">Advanced Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Vizard/vizardGallery.html">Video Gallery</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Basilisk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../Learn.html">Learning Basilisk</a> &raquo;</li>
        
          <li><a href="../makingModules.html">Basics of Writing Basilisk Modules</a> &raquo;</li>
        
      <li>Making Python Modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/Learn/makingModules/pyModules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="making-python-modules">
<span id="pymodules"></span><h1>Making Python Modules<a class="headerlink" href="#making-python-modules" title="Permalink to this headline">Â¶</a></h1>
<aside class="sidebar">
<p class="sidebar-title">Source Code</p>
<p>The Python code shown below can be downloaded <a class="reference download internal" download="" href="../../_downloads/2d7d1518dc37d8697664285f2149d779/making-pyModules.py"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>.</p>
</aside>
<p>Python modules are a good alternative to C and C++ modules for quick prototyping.
They are defined entirely in a Python script, which means that there is no need
for a header (<code class="docutils literal notranslate"><span class="pre">.h</span></code>), definition (<code class="docutils literal notranslate"><span class="pre">.cpp</span></code>), or SWIG interface file (<code class="docutils literal notranslate"><span class="pre">.i</span></code>). However, they
are much slower than C or C++ modules, which will significantly slow down your simulation.</p>
<p>Python modules are implemented by subclassing <code class="docutils literal notranslate"><span class="pre">SysModel</span></code> from <code class="docutils literal notranslate"><span class="pre">Basilisk.architecture.sysModel</span></code>.
Then, one can implement the <code class="docutils literal notranslate"><span class="pre">__init__</span></code>,
<code class="docutils literal notranslate"><span class="pre">Reset</span></code>, and <code class="docutils literal notranslate"><span class="pre">UpdateState</span></code> methods in the same way that one would
implement these methods in C++. Remember to always call <code class="docutils literal notranslate"><span class="pre">__init__</span></code> of
the parent class <code class="docutils literal notranslate"><span class="pre">SysModel</span></code> if you are implementing your own <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ModelTag</span></code> value of these python BSK modules will be a unique positive number,
same as with C/C++ BSK modules.</p>
<p>All Python modules have a logger stored in <code class="docutils literal notranslate"><span class="pre">bskLogger</span></code> (although it will
not be available until the module has been added to a simulation). Additionally,
you may declare any other variables, methods, messages, etc. within your Python module.</p>
<p>The script below expands on the code shown in <a class="reference internal" href="../bskPrinciples/bskPrinciples-2.html#bskprinciples-2"><span class="std std-ref">Adding Basilisk Modules</span></a> to include
a Python module.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span>
<span class="linenos">  2</span><span class="kn">from</span> <span class="nn">Basilisk.utilities</span> <span class="kn">import</span> <span class="n">SimulationBaseClass</span>
<span class="linenos">  3</span><span class="kn">from</span> <span class="nn">Basilisk.utilities</span> <span class="kn">import</span> <span class="n">macros</span>
<span class="linenos">  4</span><span class="kn">from</span> <span class="nn">Basilisk.moduleTemplates</span> <span class="kn">import</span> <span class="n">cModuleTemplate</span>
<span class="linenos">  5</span><span class="kn">from</span> <span class="nn">Basilisk.moduleTemplates</span> <span class="kn">import</span> <span class="n">cppModuleTemplate</span>
<span class="linenos">  6</span><span class="kn">from</span> <span class="nn">Basilisk.architecture</span> <span class="kn">import</span> <span class="n">sysModel</span>
<span class="linenos">  7</span><span class="kn">from</span> <span class="nn">Basilisk.architecture</span> <span class="kn">import</span> <span class="n">bskLogging</span>
<span class="linenos">  8</span><span class="kn">from</span> <span class="nn">Basilisk.architecture</span> <span class="kn">import</span> <span class="n">messaging</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 11</span>
<span class="linenos"> 12</span>
<span class="linenos"> 13</span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="linenos"> 14</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 15</span><span class="sd">    Illustration of adding Basilisk Python modules to a task</span>
<span class="linenos"> 16</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span>    <span class="c1">#  Create a sim module as an empty container</span>
<span class="linenos"> 19</span>    <span class="n">scSim</span> <span class="o">=</span> <span class="n">SimulationBaseClass</span><span class="o">.</span><span class="n">SimBaseClass</span><span class="p">()</span>
<span class="linenos"> 20</span>
<span class="linenos"> 21</span>    <span class="c1">#  create the simulation process</span>
<span class="linenos"> 22</span>    <span class="n">dynProcess</span> <span class="o">=</span> <span class="n">scSim</span><span class="o">.</span><span class="n">CreateNewProcess</span><span class="p">(</span><span class="s2">&quot;dynamicsProcess&quot;</span><span class="p">)</span>
<span class="linenos"> 23</span>
<span class="linenos"> 24</span>    <span class="c1"># create the dynamics task and specify the integration update time</span>
<span class="linenos"> 25</span>    <span class="n">dynProcess</span><span class="o">.</span><span class="n">addTask</span><span class="p">(</span><span class="n">scSim</span><span class="o">.</span><span class="n">CreateNewTask</span><span class="p">(</span><span class="s2">&quot;dynamicsTask&quot;</span><span class="p">,</span> <span class="n">macros</span><span class="o">.</span><span class="n">sec2nano</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)))</span>
<span class="linenos"> 26</span>
<span class="linenos"> 27</span>    <span class="c1"># create copies of the Basilisk modules</span>
<span class="linenos"> 28</span>    <span class="n">mod1</span> <span class="o">=</span> <span class="n">cModuleTemplate</span><span class="o">.</span><span class="n">cModuleTemplate</span><span class="p">()</span>
<span class="linenos"> 29</span>    <span class="n">mod1</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;cModule1&quot;</span>
<span class="linenos"> 30</span>    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="s2">&quot;dynamicsTask&quot;</span><span class="p">,</span> <span class="n">mod1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 31</span>
<span class="linenos"> 32</span>    <span class="n">mod2</span> <span class="o">=</span> <span class="n">cppModuleTemplate</span><span class="o">.</span><span class="n">CppModuleTemplate</span><span class="p">()</span>
<span class="linenos"> 33</span>    <span class="n">mod2</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;cppModule2&quot;</span>
<span class="linenos"> 34</span>    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="s2">&quot;dynamicsTask&quot;</span><span class="p">,</span> <span class="n">mod2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="linenos"> 35</span>
<span class="linenos"> 36</span>    <span class="n">mod3</span> <span class="o">=</span> <span class="n">cModuleTemplate</span><span class="o">.</span><span class="n">cModuleTemplate</span><span class="p">()</span>
<span class="linenos"> 37</span>    <span class="n">mod3</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;cModule3&quot;</span>
<span class="linenos"> 38</span>    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="s2">&quot;dynamicsTask&quot;</span><span class="p">,</span> <span class="n">mod3</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="linenos"> 39</span>
<span class="linenos"> 40</span>    <span class="c1"># The following is a Python module, which has a higher priority</span>
<span class="linenos"> 41</span>    <span class="c1"># then some of the C++/C modules. Observe in the script output</span>
<span class="linenos"> 42</span>    <span class="c1"># how the Python module is called in the order that respects</span>
<span class="linenos"> 43</span>    <span class="c1"># its priority with respect to the rest of the modules.</span>
<span class="linenos"> 44</span>    <span class="n">mod4</span> <span class="o">=</span> <span class="n">TestPythonModule</span><span class="p">()</span>
<span class="linenos"> 45</span>    <span class="n">mod4</span><span class="o">.</span><span class="n">ModelTag</span> <span class="o">=</span> <span class="s2">&quot;pythonModule4&quot;</span>
<span class="linenos"> 46</span>    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="s2">&quot;dynamicsTask&quot;</span><span class="p">,</span> <span class="n">mod4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span>    <span class="n">mod2</span><span class="o">.</span><span class="n">dataInMsg</span><span class="o">.</span><span class="n">subscribeTo</span><span class="p">(</span><span class="n">mod4</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="p">)</span>
<span class="linenos"> 49</span>    <span class="n">mod4</span><span class="o">.</span><span class="n">dataInMsg</span><span class="o">.</span><span class="n">subscribeTo</span><span class="p">(</span><span class="n">mod3</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="p">)</span>
<span class="linenos"> 50</span>
<span class="linenos"> 51</span>    <span class="c1"># Set up recording</span>
<span class="linenos"> 52</span>    <span class="n">mod2MsgRecorder</span> <span class="o">=</span> <span class="n">mod2</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="o">.</span><span class="n">recorder</span><span class="p">()</span>
<span class="linenos"> 53</span>    <span class="n">scSim</span><span class="o">.</span><span class="n">AddModelToTask</span><span class="p">(</span><span class="s2">&quot;dynamicsTask&quot;</span><span class="p">,</span> <span class="n">mod2MsgRecorder</span><span class="p">)</span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span>    <span class="c1">#  initialize Simulation:</span>
<span class="linenos"> 56</span>    <span class="n">scSim</span><span class="o">.</span><span class="n">InitializeSimulation</span><span class="p">()</span>
<span class="linenos"> 57</span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;InitializeSimulation() completed...&quot;</span><span class="p">)</span>
<span class="linenos"> 58</span>
<span class="linenos"> 59</span>    <span class="c1">#   configure a simulation stop time and execute the simulation run</span>
<span class="linenos"> 60</span>    <span class="n">scSim</span><span class="o">.</span><span class="n">ConfigureStopTime</span><span class="p">(</span><span class="n">macros</span><span class="o">.</span><span class="n">sec2nano</span><span class="p">(</span><span class="mf">5.0</span><span class="p">))</span>
<span class="linenos"> 61</span>    <span class="n">scSim</span><span class="o">.</span><span class="n">ExecuteSimulation</span><span class="p">()</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Recorded mod2.dataOutMsg.dataVector: &quot;</span><span class="p">,</span> <span class="n">mod2MsgRecorder</span><span class="o">.</span><span class="n">dataVector</span><span class="p">)</span>
<span class="linenos"> 64</span>
<span class="linenos"> 65</span>    <span class="k">return</span>
<span class="linenos"> 66</span>
<span class="linenos"> 67</span>
<span class="linenos"> 68</span><span class="k">class</span> <span class="nc">TestPythonModule</span><span class="p">(</span><span class="n">sysModel</span><span class="o">.</span><span class="n">SysModel</span><span class="p">):</span>
<span class="linenos"> 69</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="linenos"> 70</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="linenos"> 71</span>        <span class="bp">self</span><span class="o">.</span><span class="n">dataInMsg</span> <span class="o">=</span> <span class="n">messaging</span><span class="o">.</span><span class="n">CModuleTemplateMsgReader</span><span class="p">()</span>
<span class="linenos"> 72</span>        <span class="bp">self</span><span class="o">.</span><span class="n">dataOutMsg</span> <span class="o">=</span> <span class="n">messaging</span><span class="o">.</span><span class="n">CModuleTemplateMsg</span><span class="p">()</span>
<span class="linenos"> 73</span>
<span class="linenos"> 74</span>    <span class="k">def</span> <span class="nf">Reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CurrentSimNanos</span><span class="p">):</span>
<span class="linenos"> 75</span>        <span class="c1"># Ensure that self.dataInMsg is linked</span>
<span class="linenos"> 76</span>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataInMsg</span><span class="o">.</span><span class="n">isLinked</span><span class="p">():</span>
<span class="linenos"> 77</span>            <span class="bp">self</span><span class="o">.</span><span class="n">bskLogger</span><span class="o">.</span><span class="n">bskLog</span><span class="p">(</span>
<span class="linenos"> 78</span>                <span class="n">bskLogging</span><span class="o">.</span><span class="n">BSK_ERROR</span><span class="p">,</span> <span class="s2">&quot;TestPythonModule.dataInMsg is not linked.&quot;</span>
<span class="linenos"> 79</span>            <span class="p">)</span>
<span class="linenos"> 80</span>
<span class="linenos"> 81</span>        <span class="c1"># Initialiazing self.dataOutMsg</span>
<span class="linenos"> 82</span>        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="o">.</span><span class="n">zeroMsgPayload</span>
<span class="linenos"> 83</span>        <span class="n">payload</span><span class="o">.</span><span class="n">dataVector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="linenos"> 84</span>        <span class="bp">self</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">CurrentSimNanos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">moduleID</span><span class="p">)</span>
<span class="linenos"> 85</span>
<span class="linenos"> 86</span>        <span class="bp">self</span><span class="o">.</span><span class="n">bskLogger</span><span class="o">.</span><span class="n">bskLog</span><span class="p">(</span><span class="n">bskLogging</span><span class="o">.</span><span class="n">BSK_INFORMATION</span><span class="p">,</span> <span class="s2">&quot;Reset in TestPythonModule&quot;</span><span class="p">)</span>
<span class="linenos"> 87</span>
<span class="linenos"> 88</span>    <span class="k">def</span> <span class="nf">UpdateState</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CurrentSimNanos</span><span class="p">):</span>
<span class="linenos"> 89</span>        <span class="c1"># Read input message</span>
<span class="linenos"> 90</span>        <span class="n">inPayload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataInMsg</span><span class="p">()</span>
<span class="linenos"> 91</span>        <span class="n">inputVector</span> <span class="o">=</span> <span class="n">inPayload</span><span class="o">.</span><span class="n">dataVector</span>
<span class="linenos"> 92</span>
<span class="linenos"> 93</span>        <span class="c1"># Set output message</span>
<span class="linenos"> 94</span>        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="o">.</span><span class="n">zeroMsgPayload</span>
<span class="linenos"> 95</span>        <span class="n">payload</span><span class="o">.</span><span class="n">dataVector</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 96</span>            <span class="bp">self</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">dataVector</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">inputVector</span>
<span class="linenos"> 97</span>        <span class="p">)</span>
<span class="linenos"> 98</span>        <span class="bp">self</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">CurrentSimNanos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">moduleID</span><span class="p">)</span>
<span class="linenos"> 99</span>
<span class="linenos">100</span>        <span class="bp">self</span><span class="o">.</span><span class="n">bskLogger</span><span class="o">.</span><span class="n">bskLog</span><span class="p">(</span>
<span class="linenos">101</span>            <span class="n">bskLogging</span><span class="o">.</span><span class="n">BSK_INFORMATION</span><span class="p">,</span>
<span class="linenos">102</span>            <span class="sa">f</span><span class="s2">&quot;Python Module ID </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">moduleID</span><span class="si">}</span><span class="s2"> ran Update at </span><span class="si">{</span><span class="n">CurrentSimNanos</span><span class="o">*</span><span class="mf">1e-9</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">,</span>
<span class="linenos">103</span>        <span class="p">)</span>
<span class="linenos">104</span>
<span class="linenos">105</span>
<span class="linenos">106</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">107</span>    <span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Running the above code prints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">.</span><span class="n">venv</span><span class="p">)</span> <span class="n">source</span><span class="o">/</span><span class="n">codeSamples</span> <span class="o">%</span> <span class="n">python</span> <span class="n">making</span><span class="o">-</span><span class="n">pyModules</span><span class="o">.</span><span class="n">py</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">Variable</span> <span class="n">dummy</span> <span class="nb">set</span> <span class="n">to</span> <span class="mf">0.000000</span> <span class="ow">in</span> <span class="n">reset</span><span class="o">.</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">Reset</span> <span class="ow">in</span> <span class="n">TestPythonModule</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">Variable</span> <span class="n">dummy</span> <span class="nb">set</span> <span class="n">to</span> <span class="mf">0.000000</span> <span class="ow">in</span> <span class="n">reset</span><span class="o">.</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">Variable</span> <span class="n">dummy</span> <span class="nb">set</span> <span class="n">to</span> <span class="mf">0.000000</span> <span class="ow">in</span> <span class="n">reset</span><span class="o">.</span>
<span class="n">InitializeSimulation</span><span class="p">()</span> <span class="n">completed</span><span class="o">...</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">C</span> <span class="n">Module</span> <span class="n">ID</span> <span class="mi">3</span> <span class="n">ran</span> <span class="n">Update</span> <span class="n">at</span> <span class="mf">0.000000</span><span class="n">s</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">Python</span> <span class="n">Module</span> <span class="n">ID</span> <span class="mi">4</span> <span class="n">ran</span> <span class="n">Update</span> <span class="n">at</span> <span class="mf">0.0</span><span class="n">s</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">C</span><span class="o">++</span> <span class="n">Module</span> <span class="n">ID</span> <span class="mi">2</span> <span class="n">ran</span> <span class="n">Update</span> <span class="n">at</span> <span class="mf">0.000000</span><span class="n">s</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">C</span> <span class="n">Module</span> <span class="n">ID</span> <span class="mi">1</span> <span class="n">ran</span> <span class="n">Update</span> <span class="n">at</span> <span class="mf">0.000000</span><span class="n">s</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">C</span> <span class="n">Module</span> <span class="n">ID</span> <span class="mi">3</span> <span class="n">ran</span> <span class="n">Update</span> <span class="n">at</span> <span class="mf">5.000000</span><span class="n">s</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">Python</span> <span class="n">Module</span> <span class="n">ID</span> <span class="mi">4</span> <span class="n">ran</span> <span class="n">Update</span> <span class="n">at</span> <span class="mf">5.0</span><span class="n">s</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">C</span><span class="o">++</span> <span class="n">Module</span> <span class="n">ID</span> <span class="mi">2</span> <span class="n">ran</span> <span class="n">Update</span> <span class="n">at</span> <span class="mf">5.000000</span><span class="n">s</span>
<span class="n">BSK_INFORMATION</span><span class="p">:</span> <span class="n">C</span> <span class="n">Module</span> <span class="n">ID</span> <span class="mi">1</span> <span class="n">ran</span> <span class="n">Update</span> <span class="n">at</span> <span class="mf">5.000000</span><span class="n">s</span>
<span class="n">Recorded</span> <span class="n">mod2</span><span class="o">.</span><span class="n">dataOutMsg</span><span class="o">.</span><span class="n">dataVector</span><span class="p">:</span>  <span class="p">[[</span><span class="mf">2.</span> <span class="mf">1.</span> <span class="mf">0.</span><span class="p">]</span>
<span class="p">[</span><span class="mf">5.</span> <span class="mf">2.</span> <span class="mf">0.</span><span class="p">]]</span>
</pre></div>
</div>
<p>Note how the Python module made use of <code class="docutils literal notranslate"><span class="pre">bskLogger</span></code>, the <code class="docutils literal notranslate"><span class="pre">Reset</span></code>
and <code class="docutils literal notranslate"><span class="pre">UpdateState</span></code> were called, how the priority of the Python
module was respected, and how messaging happened between a C++
and Python module.</p>
<p>The scenario <a class="reference internal" href="../../examples/scenarioAttitudePointingPy.html#scenarioattitudepointingpy"><span class="std std-ref">scenarioAttitudePointingPy</span></a> further shows how to define Python modules.</p>
<section id="deprecated-way-of-creating-python-modules">
<h2>Deprecated way of creating Python modules<a class="headerlink" href="#deprecated-way-of-creating-python-modules" title="Permalink to this headline">Â¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This section discusses the deprecated way of setting up Python modules
in Basilisk versions earlier than 2.2.
Users should refer to the previous section when setting up new simulation
scripts using Python modules.</p>
</div>
<p>Apart from the way to shown above, there exist an older way to create
Python modules which has now been deprecated. This section briefly
discusses this older method, its disadvantages, and how to update to the
new system. Note that this deprecated method is pending for removal;
users are advised to update to the new system.</p>
<p>Before the new system, Python modules had to be added to separate
Python processes, which could not have C/C++ modules. Moreover, this
Python processes always had to have a lower priority than C++/C
processes, which effectively meant that all Python modules would run
after the C++/C modules. This severely limited usersâ control of the
execution order of their simulation.</p>
<p>Moreover, the syntax for creating these modules was slightly different
than for C++ modules:</p>
<ul class="simple">
<li><p>The class inherited from <code class="docutils literal notranslate"><span class="pre">PythonModelClass</span></code> instead of <code class="docutils literal notranslate"><span class="pre">SysModel</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">ModelTag</span></code> had to be passed to the constructor of the class</p></li>
<li><p>One had to overload <code class="docutils literal notranslate"><span class="pre">reset</span></code> and <code class="docutils literal notranslate"><span class="pre">updateState</span></code>, instead of <code class="docutils literal notranslate"><span class="pre">Reset</span></code> and <code class="docutils literal notranslate"><span class="pre">UpdateState</span></code></p></li>
</ul>
<p>In order to update python simulation scripts that use the deprecated system to the
new system, one needs to:</p>
<ul class="simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">CreateNewPythonProcess</span></code> by <code class="docutils literal notranslate"><span class="pre">CreateNewProcess</span></code>, as the new Python modules
can be added to regular processes.</p></li>
<li><p>Make the Python module class inherit from <code class="docutils literal notranslate"><span class="pre">SysModel</span></code>, and not from <code class="docutils literal notranslate"><span class="pre">PythonModelClass</span></code>
Note that you must import <code class="docutils literal notranslate"><span class="pre">SysModel</span></code> from <code class="docutils literal notranslate"><span class="pre">Basilisk.architecture.sysModel</span></code>.</p></li>
<li><p>Instead of passing the module tag and priority in the constructor, set the tag by
setting the <code class="docutils literal notranslate"><span class="pre">ModuleTag</span></code> attribute (similar to C++ modules), and set the priority on the <code class="docutils literal notranslate"><span class="pre">addTask</span></code> method.</p></li>
<li><p>Rename <code class="docutils literal notranslate"><span class="pre">selfInit</span></code>, <code class="docutils literal notranslate"><span class="pre">reset</span></code>, and <code class="docutils literal notranslate"><span class="pre">updateState</span></code> to <code class="docutils literal notranslate"><span class="pre">SelftInit</span></code>, <code class="docutils literal notranslate"><span class="pre">Reset</span></code>, and <code class="docutils literal notranslate"><span class="pre">UpdateState</span></code>.</p></li>
</ul>
<p>With this depreciated manner of creating a python Basilisk module the <code class="docutils literal notranslate"><span class="pre">ModelTag</span></code> value
is an unique negative number, while the C/C++ modules had unique positive numbers.
This means that updating your simulation script
might change the ID of your modules compared to previous versions.</p>
<p>It is possible that you may not even need a separate process
for your Python modules, so consider adding the Python modules directly
to other existing processes, always with a lower priority if you want
to retain the older behaviour.</p>
<p>The scenario <a class="reference internal" href="../../examples/scenarioAttitudePointingPyDEPRECATED.html#scenarioattitudepointingpydeprecated"><span class="std std-ref">scenarioAttitudePointingPyDEPRECATED</span></a> shows both the
deprecated way of creating a Python module.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="makingModules-3.html" class="btn btn-neutral float-right" title="Module RST Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="cppModules/cppModules-5.html" class="btn btn-neutral float-left" title="C++ Module with C-Wrapped Output Message" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Autonomous Vehicle Systems (AVS) Laboratory.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>