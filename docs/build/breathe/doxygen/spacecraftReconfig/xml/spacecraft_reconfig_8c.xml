<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="spacecraft_reconfig_8c" kind="file" language="C++">
    <compoundname>spacecraftReconfig.c</compoundname>
    <includes refid="spacecraft_reconfig_8h" local="yes">spacecraftReconfig.h</includes>
    <includes local="no">string.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">math.h</includes>
    <includes local="yes">architecture/utilities/linearAlgebra.h</includes>
    <includes local="yes">architecture/utilities/astroConstants.h</includes>
    <includes local="yes">architecture/utilities/rigidBodyKinematics.h</includes>
    <incdepgraph>
      <node id="1">
        <label>/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c</label>
        <link refid="spacecraft_reconfig_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>spacecraftReconfig.h</label>
        <link refid="spacecraft_reconfig_8h_source"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>architecture/utilities/astroConstants.h</label>
      </node>
      <node id="10">
        <label>architecture/utilities/bskLogging.h</label>
      </node>
      <node id="15">
        <label>architecture/utilities/linearAlgebra.h</label>
      </node>
      <node id="11">
        <label>architecture/utilities/orbitalMotion.h</label>
      </node>
      <node id="17">
        <label>architecture/utilities/rigidBodyKinematics.h</label>
      </node>
      <node id="6">
        <label>cMsgCInterface/AttRefMsg_C.h</label>
      </node>
      <node id="4">
        <label>cMsgCInterface/NavTransMsg_C.h</label>
      </node>
      <node id="9">
        <label>cMsgCInterface/ReconfigBurnArrayInfoMsg_C.h</label>
      </node>
      <node id="5">
        <label>cMsgCInterface/THRArrayConfigMsg_C.h</label>
      </node>
      <node id="7">
        <label>cMsgCInterface/THRArrayOnTimeCmdMsg_C.h</label>
      </node>
      <node id="8">
        <label>cMsgCInterface/VehicleConfigMsg_C.h</label>
      </node>
      <node id="14">
        <label>math.h</label>
      </node>
      <node id="3">
        <label>stdint.h</label>
      </node>
      <node id="13">
        <label>stdlib.h</label>
      </node>
      <node id="12">
        <label>string.h</label>
      </node>
    </incdepgraph>
    <sectiondef kind="func">
      <memberdef kind="function" id="spacecraft_reconfig_8c_1af9a43fdddb12fd2d5539d0abf56a5187" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void SelfInit_spacecraftReconfig</definition>
        <argsstring>(spacecraftReconfigConfig *configData, int64_t moduleID)</argsstring>
        <name>SelfInit_spacecraftReconfig</name>
        <param>
          <type><ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref> *</type>
          <declname>configData</declname>
        </param>
        <param>
          <type>int64_t</type>
          <declname>moduleID</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This method initializes the configData for this module. It checks to ensure that the inputs are sane and then creates the output message <simplesect kind="return"><para>void </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>configData</parametername>
</parameternamelist>
<parameterdescription>
<para>The configuration data associated with this module </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>moduleID</parametername>
</parameternamelist>
<parameterdescription>
<para>The Basilisk module identifier </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" line="36" column="6" bodyfile="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" bodystart="36" bodyend="41"/>
      </memberdef>
      <memberdef kind="function" id="spacecraft_reconfig_8c_1aecd8ff0667d77d46bb3377b2355b13b7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void Reset_spacecraftReconfig</definition>
        <argsstring>(spacecraftReconfigConfig *configData, uint64_t callTime, int64_t moduleID)</argsstring>
        <name>Reset_spacecraftReconfig</name>
        <param>
          <type><ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref> *</type>
          <declname>configData</declname>
        </param>
        <param>
          <type>uint64_t</type>
          <declname>callTime</declname>
        </param>
        <param>
          <type>int64_t</type>
          <declname>moduleID</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This method performs a complete reset of the module. Local module variables that retain time varying states between function calls are reset to their default values. The local copy of the message output buffer should be cleared. <simplesect kind="return"><para>void </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>configData</parametername>
</parameternamelist>
<parameterdescription>
<para>The configuration data associated with the module </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>callTime</parametername>
</parameternamelist>
<parameterdescription>
<para>The clock time at which the function was called (nanoseconds) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>moduleID</parametername>
</parameternamelist>
<parameterdescription>
<para>The Basilisk module identifier </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" line="52" column="6" bodyfile="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" bodystart="52" bodyend="78"/>
      </memberdef>
      <memberdef kind="function" id="spacecraft_reconfig_8c_1a479b1be26d5f862a9d58195647a552d6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void Update_spacecraftReconfig</definition>
        <argsstring>(spacecraftReconfigConfig *configData, uint64_t callTime, int64_t moduleID)</argsstring>
        <name>Update_spacecraftReconfig</name>
        <param>
          <type><ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref> *</type>
          <declname>configData</declname>
        </param>
        <param>
          <type>uint64_t</type>
          <declname>callTime</declname>
        </param>
        <param>
          <type>int64_t</type>
          <declname>moduleID</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Add a description of what this main Update() routine does for this module <simplesect kind="return"><para>void </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>configData</parametername>
</parameternamelist>
<parameterdescription>
<para>The configuration data associated with the module </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>callTime</parametername>
</parameternamelist>
<parameterdescription>
<para>The clock time at which the function was called (nanoseconds) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>moduleID</parametername>
</parameternamelist>
<parameterdescription>
<para>The Basilisk module identifier </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
<para><itemizedlist>
<listitem><para>Read the input messages</para>
</listitem></itemizedlist>
</para>
<para><itemizedlist>
<listitem><para>write the module output messages</para>
</listitem></itemizedlist>
</para>
        </inbodydescription>
        <location file="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" line="86" column="6" bodyfile="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" bodystart="86" bodyend="131"/>
      </memberdef>
      <memberdef kind="function" id="spacecraft_reconfig_8c_1a84fd62d338c03c77698d6fe490fda5c3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void UpdateManeuver</definition>
        <argsstring>(spacecraftReconfigConfig *configData, NavTransMsgPayload chiefTransMsgBuffer, NavTransMsgPayload deputyTransMsgBuffer, AttRefMsgPayload attRefInMsgBuffer, THRArrayConfigMsgPayload thrustConfigMsgBuffer, VehicleConfigMsgPayload vehicleConfigMsgBuffer, AttRefMsgPayload *attRefOutMsgBuffer, THRArrayOnTimeCmdMsgPayload *thrustOnMsgBuffer, uint64_t callTime, int64_t moduleID)</argsstring>
        <name>UpdateManeuver</name>
        <param>
          <type><ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref> *</type>
          <declname>configData</declname>
        </param>
        <param>
          <type>NavTransMsgPayload</type>
          <declname>chiefTransMsgBuffer</declname>
        </param>
        <param>
          <type>NavTransMsgPayload</type>
          <declname>deputyTransMsgBuffer</declname>
        </param>
        <param>
          <type>AttRefMsgPayload</type>
          <declname>attRefInMsgBuffer</declname>
        </param>
        <param>
          <type>THRArrayConfigMsgPayload</type>
          <declname>thrustConfigMsgBuffer</declname>
        </param>
        <param>
          <type>VehicleConfigMsgPayload</type>
          <declname>vehicleConfigMsgBuffer</declname>
        </param>
        <param>
          <type>AttRefMsgPayload *</type>
          <declname>attRefOutMsgBuffer</declname>
        </param>
        <param>
          <type>THRArrayOnTimeCmdMsgPayload *</type>
          <declname>thrustOnMsgBuffer</declname>
        </param>
        <param>
          <type>uint64_t</type>
          <declname>callTime</declname>
        </param>
        <param>
          <type>int64_t</type>
          <declname>moduleID</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>based on burn schedule, this function creates a message of reference attitude and thruster on time <simplesect kind="return"><para>void </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>configData</parametername>
</parameternamelist>
<parameterdescription>
<para>The configuration data associated with the module </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>chiefTransMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para>chief&apos;s position and velocity </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>deputyTransMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para>deputy&apos;s position and velocity </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>attRefInMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para>target attitude </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>thrustConfigMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para>thruster&apos;s config information </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>vehicleConfigMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para>deputy&apos;s vehicle config information </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>attRefOutMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para>target attitude </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>thrustOnMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para>thruster on time </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>callTime</parametername>
</parameternamelist>
<parameterdescription>
<para>The clock time at which the function was called (nanoseconds) </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>moduleID</parametername>
</parameternamelist>
<parameterdescription>
<para>The Basilisk module identifier </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" line="147" column="6" bodyfile="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" bodystart="147" bodyend="278"/>
      </memberdef>
      <memberdef kind="function" id="spacecraft_reconfig_8c_1ab4ed8ba4d9fca4b0310b4dd3e8776781" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>double</type>
        <definition>double AdjustRange</definition>
        <argsstring>(double lower, double upper, double angle)</argsstring>
        <name>AdjustRange</name>
        <param>
          <type>double</type>
          <declname>lower</declname>
        </param>
        <param>
          <type>double</type>
          <declname>upper</declname>
        </param>
        <param>
          <type>double</type>
          <declname>angle</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This function is used to adjust a certain value in a certain range between lower threshold and upper threshold. This function is particularily used to adjsut angles used in orbital motions such as True Anomaly, Mean Anomaly, and so on. <simplesect kind="return"><para>double </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>lower</parametername>
</parameternamelist>
<parameterdescription>
<para>lower threshold </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>upper</parametername>
</parameternamelist>
<parameterdescription>
<para>upper threshold </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>angle</parametername>
</parameternamelist>
<parameterdescription>
<para>an angle which you want to be between lower and upper </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" line="287" column="8" bodyfile="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" bodystart="287" bodyend="302"/>
      </memberdef>
      <memberdef kind="function" id="spacecraft_reconfig_8c_1acdd04d7c28a8051510cffec4aebfa853" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int CompareTime</definition>
        <argsstring>(const void *n1, const void *n2)</argsstring>
        <name>CompareTime</name>
        <param>
          <type>const void *</type>
          <declname>n1</declname>
        </param>
        <param>
          <type>const void *</type>
          <declname>n2</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This function is used to sort an array of spacecraftReconfigConfigBurnInfo in ascending order. <simplesect kind="return"><para>void </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>n1</parametername>
</parameternamelist>
<parameterdescription>
<para></para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>n2</parametername>
</parameternamelist>
<parameterdescription>
<para></para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" line="310" column="5" bodyfile="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" bodystart="310" bodyend="324"/>
      </memberdef>
      <memberdef kind="function" id="spacecraft_reconfig_8c_1ac83d232fa86f9fce653b285ee06d2dbd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ScheduleDV</definition>
        <argsstring>(spacecraftReconfigConfig *configData, classicElements oe_c, classicElements oe_d, THRArrayConfigMsgPayload thrustConfigMsgBuffer, VehicleConfigMsgPayload vehicleConfigMsgBuffer)</argsstring>
        <name>ScheduleDV</name>
        <param>
          <type><ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref> *</type>
          <declname>configData</declname>
        </param>
        <param>
          <type>classicElements</type>
          <declname>oe_c</declname>
        </param>
        <param>
          <type>classicElements</type>
          <declname>oe_d</declname>
        </param>
        <param>
          <type>THRArrayConfigMsgPayload</type>
          <declname>thrustConfigMsgBuffer</declname>
        </param>
        <param>
          <type>VehicleConfigMsgPayload</type>
          <declname>vehicleConfigMsgBuffer</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This function is used to sort an array of spacecraftReconfigConfigBurnInfo in ascending order. <simplesect kind="return"><para>void </para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>configData</parametername>
</parameternamelist>
<parameterdescription>
<para>The configuration data associated with this module </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>oe_c</parametername>
</parameternamelist>
<parameterdescription>
<para>chief&apos;s orbital element </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>oe_d</parametername>
</parameternamelist>
<parameterdescription>
<para>deputy&apos;s orbital element </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>thrustConfigMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para></para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>vehicleConfigMsgBuffer</parametername>
</parameternamelist>
<parameterdescription>
<para>deputy&apos;s vehicle config information </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" line="335" column="6" bodyfile="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c" bodystart="335" bodyend="598"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>ISC<sp/>License</highlight></codeline>
<codeline lineno="3"><highlight class="comment"></highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>Copyright<sp/>(c)<sp/>2016,<sp/>Autonomous<sp/>Vehicle<sp/>Systems<sp/>Lab,<sp/>University<sp/>of<sp/>Colorado<sp/>at<sp/>Boulder</highlight></codeline>
<codeline lineno="5"><highlight class="comment"></highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>Permission<sp/>to<sp/>use,<sp/>copy,<sp/>modify,<sp/>and/or<sp/>distribute<sp/>this<sp/>software<sp/>for<sp/>any</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>purpose<sp/>with<sp/>or<sp/>without<sp/>fee<sp/>is<sp/>hereby<sp/>granted,<sp/>provided<sp/>that<sp/>the<sp/>above</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>copyright<sp/>notice<sp/>and<sp/>this<sp/>permission<sp/>notice<sp/>appear<sp/>in<sp/>all<sp/>copies.</highlight></codeline>
<codeline lineno="9"><highlight class="comment"></highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>THE<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>&quot;AS<sp/>IS&quot;<sp/>AND<sp/>THE<sp/>AUTHOR<sp/>DISCLAIMS<sp/>ALL<sp/>WARRANTIES</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>WITH<sp/>REGARD<sp/>TO<sp/>THIS<sp/>SOFTWARE<sp/>INCLUDING<sp/>ALL<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS.<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>AUTHOR<sp/>BE<sp/>LIABLE<sp/>FOR</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>ANY<sp/>SPECIAL,<sp/>DIRECT,<sp/>INDIRECT,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>OR<sp/>ANY<sp/>DAMAGES</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>WHATSOEVER<sp/>RESULTING<sp/>FROM<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA<sp/>OR<sp/>PROFITS,<sp/>WHETHER<sp/>IN<sp/>AN</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>ACTION<sp/>OF<sp/>CONTRACT,<sp/>NEGLIGENCE<sp/>OR<sp/>OTHER<sp/>TORTIOUS<sp/>ACTION,<sp/>ARISING<sp/>OUT<sp/>OF</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>OR<sp/>IN<sp/>CONNECTION<sp/>WITH<sp/>THE<sp/>USE<sp/>OR<sp/>PERFORMANCE<sp/>OF<sp/>THIS<sp/>SOFTWARE.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"></highlight></codeline>
<codeline lineno="18"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;spacecraftReconfig.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;architecture/utilities/linearAlgebra.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;architecture/utilities/astroConstants.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;architecture/utilities/rigidBodyKinematics.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>SelfInit_spacecraftReconfig(<ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref><sp/>*configData,<sp/>int64_t<sp/>moduleID)</highlight></codeline>
<codeline lineno="37"><highlight class="normal">{</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>AttRefMsg_C_init(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a2015f14182290734b9e1711ad5b2eda6" kindref="member">attRefOutMsg</ref>);</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/>THRArrayOnTimeCmdMsg_C_init(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1ae8f8ea5b41091405b4ce19b81bdc57e0" kindref="member">onTimeOutMsg</ref>);</highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/>ReconfigBurnArrayInfoMsg_C_init(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a69e5a003b8faa57bf153e4aab0cb5630" kindref="member">burnArrayInfoOutMsg</ref>);</highlight></codeline>
<codeline lineno="41"><highlight class="normal">}</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Reset_spacecraftReconfig(<ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref><sp/>*configData,<sp/>uint64_t<sp/>callTime,<sp/>int64_t<sp/>moduleID)</highlight></codeline>
<codeline lineno="53"><highlight class="normal">{</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>if<sp/>the<sp/>required<sp/>input<sp/>messages<sp/>are<sp/>included</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!NavTransMsg_C_isLinked(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1abf10ed48e4972cbaa29860b81af4b86a" kindref="member">chiefTransInMsg</ref>))<sp/>{</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_bskLog(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a2d38de4f42d167fae98ecd058199e3ea" kindref="member">bskLogger</ref>,<sp/>BSK_ERROR,<sp/></highlight><highlight class="stringliteral">&quot;Error:<sp/>spacecraftReconfig.chiefTransInMsg<sp/>wasn&apos;t<sp/>connected.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!NavTransMsg_C_isLinked(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad4b886a0f49e853f513dae344b95fe49" kindref="member">deputyTransInMsg</ref>))<sp/>{</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_bskLog(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a2d38de4f42d167fae98ecd058199e3ea" kindref="member">bskLogger</ref>,<sp/>BSK_ERROR,<sp/></highlight><highlight class="stringliteral">&quot;Error:<sp/>spacecraftReconfig.deputyTransInMsg<sp/>wasn&apos;t<sp/>connected.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!THRArrayConfigMsg_C_isLinked(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1ab14c4f0d13a714088331ee68565a67fb" kindref="member">thrustConfigInMsg</ref>))<sp/>{</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_bskLog(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a2d38de4f42d167fae98ecd058199e3ea" kindref="member">bskLogger</ref>,<sp/>BSK_ERROR,<sp/></highlight><highlight class="stringliteral">&quot;Error:<sp/>spacecraftReconfig.thrustConfigInMsg<sp/>wasn&apos;t<sp/>connected.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!VehicleConfigMsg_C_isLinked(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a29d4b0513acedcf87b4dc751063e1be0" kindref="member">vehicleConfigInMsg</ref>))<sp/>{</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_bskLog(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a2d38de4f42d167fae98ecd058199e3ea" kindref="member">bskLogger</ref>,<sp/>BSK_ERROR,<sp/></highlight><highlight class="stringliteral">&quot;Error:<sp/>spacecraftReconfig.vehicleConfigInMsg<sp/>wasn&apos;t<sp/>connected.&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>zero<sp/>the<sp/>burn<sp/>info<sp/>buffer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref><sp/>=<sp/>ReconfigBurnArrayInfoMsg_C_zeroMsgPayload();</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a5aea9dfe849de6dc1c762847fa1b1f3a" kindref="member">prevCallTime</ref><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad6f1b0962df6f7541810df7fb7d698e8" kindref="member">attRefInIsLinked</ref><sp/>=<sp/>AttRefMsg_C_isLinked(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a73dd63c79249eb3ff9745864ce79c609" kindref="member">attRefInMsg</ref>);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="78"><highlight class="normal">}</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>Update_spacecraftReconfig(<ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref><sp/>*configData,<sp/>uint64_t<sp/>callTime,<sp/>int64_t<sp/>moduleID)</highlight></codeline>
<codeline lineno="87"><highlight class="normal">{</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>NavTransMsgPayload<sp/>chiefTransMsgBuffer;</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/>NavTransMsgPayload<sp/>deputyTransMsgBuffer;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/>THRArrayConfigMsgPayload<sp/>thrustConfigMsgBuffer;</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/>AttRefMsgPayload<sp/>attRefInMsgBuffer;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/>VehicleConfigMsgPayload<sp/>vehicleConfigMsgBuffer;</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>out</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/>AttRefMsgPayload<sp/>attRefOutMsgBuffer;</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>THRArrayOnTimeCmdMsgPayload<sp/>thrustOnMsgBuffer;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/>chiefTransMsgBuffer<sp/>=<sp/>NavTransMsg_C_read(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1abf10ed48e4972cbaa29860b81af4b86a" kindref="member">chiefTransInMsg</ref>);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/>deputyTransMsgBuffer<sp/>=<sp/>NavTransMsg_C_read(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad4b886a0f49e853f513dae344b95fe49" kindref="member">deputyTransInMsg</ref>);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/>thrustConfigMsgBuffer<sp/>=<sp/>THRArrayConfigMsg_C_read(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1ab14c4f0d13a714088331ee68565a67fb" kindref="member">thrustConfigInMsg</ref>);</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>vehicleConfigMsgBuffer<sp/>=<sp/>VehicleConfigMsg_C_read(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a29d4b0513acedcf87b4dc751063e1be0" kindref="member">vehicleConfigInMsg</ref>);</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/>attRefInMsgBuffer<sp/>=<sp/>AttRefMsg_C_zeroMsgPayload();</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad6f1b0962df6f7541810df7fb7d698e8" kindref="member">attRefInIsLinked</ref>)<sp/>{</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attRefInMsgBuffer<sp/>=<sp/>AttRefMsg_C_read(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a73dd63c79249eb3ff9745864ce79c609" kindref="member">attRefInMsg</ref>);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a5aea9dfe849de6dc1c762847fa1b1f3a" kindref="member">prevCallTime</ref><sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a5aea9dfe849de6dc1c762847fa1b1f3a" kindref="member">prevCallTime</ref><sp/>=<sp/>callTime;<sp/></highlight><highlight class="comment">//<sp/>initialize</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>elapsed<sp/>time<sp/>from<sp/>last<sp/>module<sp/>updated<sp/>time</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>elapsed_time<sp/>=<sp/>((double)(callTime<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a5aea9dfe849de6dc1c762847fa1b1f3a" kindref="member">prevCallTime</ref>))<sp/>*<sp/>NANO2SEC;</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>=<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>+<sp/>elapsed_time;</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a5aea9dfe849de6dc1c762847fa1b1f3a" kindref="member">prevCallTime</ref><sp/>=<sp/>callTime;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>zero<sp/>output<sp/>messages<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>attRefOutMsgBuffer<sp/>=<sp/>AttRefMsg_C_zeroMsgPayload();</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>thrustOnMsgBuffer<sp/>=<sp/>THRArrayOnTimeCmdMsg_C_zeroMsgPayload();</highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>UpdateManeuver(configData,<sp/>chiefTransMsgBuffer,<sp/>deputyTransMsgBuffer,<sp/>attRefInMsgBuffer,</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>thrustConfigMsgBuffer,<sp/>vehicleConfigMsgBuffer,<sp/>&amp;attRefOutMsgBuffer,<sp/>&amp;thrustOnMsgBuffer,<sp/>callTime,<sp/>moduleID);</highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>AttRefMsg_C_write(&amp;attRefOutMsgBuffer,<sp/>&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a2015f14182290734b9e1711ad5b2eda6" kindref="member">attRefOutMsg</ref>,<sp/>moduleID,<sp/>callTime);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>ReconfigBurnArrayInfoMsg_C_write(&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>,<sp/>&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1a69e5a003b8faa57bf153e4aab0cb5630" kindref="member">burnArrayInfoOutMsg</ref>,<sp/>moduleID,<sp/>callTime);</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>only<sp/>when<sp/>thrustOnFlag<sp/>is<sp/>1,<sp/>thrustOnMessage<sp/>is<sp/>output</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>THRArrayOnTimeCmdMsg_C_write(&amp;thrustOnMsgBuffer,<sp/>&amp;configData-&gt;<ref refid="structspacecraft_reconfig_config_1ae8f8ea5b41091405b4ce19b81bdc57e0" kindref="member">onTimeOutMsg</ref>,<sp/>moduleID,<sp/>callTime);</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="131"><highlight class="normal">}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>UpdateManeuver(<ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref><sp/>*configData,<sp/>NavTransMsgPayload<sp/>chiefTransMsgBuffer,</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NavTransMsgPayload<sp/>deputyTransMsgBuffer,<sp/>AttRefMsgPayload<sp/>attRefInMsgBuffer,</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>THRArrayConfigMsgPayload<sp/>thrustConfigMsgBuffer,<sp/>VehicleConfigMsgPayload<sp/>vehicleConfigMsgBuffer,</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AttRefMsgPayload<sp/>*attRefOutMsgBuffer,<sp/>THRArrayOnTimeCmdMsgPayload<sp/>*thrustOnMsgBuffer,<sp/></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint64_t<sp/>callTime,<sp/>int64_t<sp/>moduleID)</highlight></codeline>
<codeline lineno="152"><highlight class="normal">{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>conversion<sp/>from<sp/>r,v<sp/>to<sp/>classical<sp/>orbital<sp/>elements<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>classicElements<sp/>oe_c,<sp/>oe_d;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>rv2elem(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6bd3b7f95e733f588a9019ed411e050a" kindref="member">mu</ref>,chiefTransMsgBuffer.r_BN_N,chiefTransMsgBuffer.v_BN_N,&amp;oe_c);</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>rv2elem(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6bd3b7f95e733f588a9019ed411e050a" kindref="member">mu</ref>,deputyTransMsgBuffer.r_BN_N,deputyTransMsgBuffer.v_BN_N,&amp;oe_d);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>schedule<sp/>dv<sp/>manuever<sp/>at<sp/>the<sp/>initiation<sp/>timing<sp/>of<sp/>this<sp/>module<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a4aa4f9c3e1a3361e19e58373c3e32dd1" kindref="member">resetPeriod</ref><sp/>=<sp/>2*M_PI/sqrt(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6bd3b7f95e733f588a9019ed411e050a" kindref="member">mu</ref>/pow(oe_c.a,3));<sp/></highlight><highlight class="comment">//<sp/>one<sp/>orbital<sp/>period</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ScheduleDV(configData,<sp/>oe_c,<sp/>oe_d,<sp/>thrustConfigMsgBuffer,<sp/>vehicleConfigMsgBuffer);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>sort<sp/>three<sp/>burns<sp/>(dvArray<sp/>structures)<sp/>in<sp/>ascending<sp/>order</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qsort(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>)<sp/>/<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0]),</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(ReconfigBurnInfoMsgPayload),<sp/>CompareTime);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>After<sp/>burn<sp/>scheduling,<sp/>the<sp/>routine<sp/>below<sp/>is<sp/>executed<sp/>at<sp/>every<sp/>time<sp/>step<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Overall,<sp/>configData-&gt;burnArrayInfoOutMsgBuffer.burnArray[i].flag<sp/>is<sp/>checked<sp/>sequentially<sp/>(i=0,1,2)<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t_left<sp/>=<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref>;<sp/></highlight><highlight class="comment">//<sp/>remaining<sp/>time<sp/>until<sp/>first<sp/>burn</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t_left<sp/>&gt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad6f1b0962df6f7541810df7fb7d698e8" kindref="member">attRefInIsLinked</ref>){</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>there<sp/>is<sp/>enough<sp/>time<sp/>until<sp/>first<sp/>burn,<sp/>so<sp/>reference<sp/>input<sp/>attitude<sp/>is<sp/>set<sp/>as<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*attRefOutMsgBuffer<sp/>=<sp/>attRefInMsgBuffer;</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>first<sp/>burn<sp/>attitude<sp/>is<sp/>set<sp/>at<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>middle<sp/>of<sp/>thruster<sp/>burn<sp/>duration<sp/>time<sp/>is<sp/>located<sp/>at<sp/>the<sp/>expected<sp/>exact<sp/>timing<sp/>of<sp/>impulsive<sp/>control</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t_left<sp/>&lt;<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/><sp/><sp/><sp/><sp/>=<sp/>1;<sp/></highlight><highlight class="comment">//<sp/>thrustOnFlag<sp/>is<sp/>ON</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/><sp/>=<sp/>2;<sp/></highlight><highlight class="comment">//<sp/>first<sp/>burn<sp/>is<sp/>regarded<sp/>as<sp/>finished<sp/>by<sp/>setting<sp/>this<sp/>to<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i<sp/>=<sp/>0;i<sp/>&lt;<sp/>thrustConfigMsgBuffer.numThrusters;++i){</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>thrustOnMsgBuffer-&gt;OnTimeRequest[i]<sp/>=<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime/thrustConfigMsgBuffer.numThrusters;</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/>=<sp/>0;<sp/></highlight><highlight class="comment">//<sp/>thrustOnFlag<sp/>is<sp/>OFF</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].flag<sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t_left<sp/>=<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref>;<sp/></highlight><highlight class="comment">//<sp/>remaining<sp/>time<sp/>until<sp/>second<sp/>burn</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>==<sp/>2<sp/>&amp;&amp;<sp/></highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>&lt;<sp/>(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t+configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters))){</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>first<sp/>burn<sp/>is<sp/>still<sp/>executed,<sp/>so<sp/>first<sp/>burn<sp/>attitude<sp/>is<sp/>set<sp/>as<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t_left<sp/>&gt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad6f1b0962df6f7541810df7fb7d698e8" kindref="member">attRefInIsLinked</ref>){</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>there<sp/>is<sp/>enough<sp/>time<sp/>until<sp/>second<sp/>burn,<sp/>so<sp/>reference<sp/>input<sp/>attitude<sp/>is<sp/>set<sp/>as<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*attRefOutMsgBuffer<sp/>=<sp/>attRefInMsgBuffer;</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>second<sp/>burn<sp/>attitude<sp/>is<sp/>set<sp/>at<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t_left<sp/>&lt;<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].flag<sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].flag<sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i<sp/>=<sp/>0;i<sp/>&lt;<sp/>thrustConfigMsgBuffer.numThrusters;++i){</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>thrustOnMsgBuffer-&gt;OnTimeRequest[i]<sp/>=<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].thrustOnTime/thrustConfigMsgBuffer.numThrusters;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>t_left<sp/>=<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref>;<sp/></highlight><highlight class="comment">//<sp/>remaining<sp/>time<sp/>until<sp/>third<sp/>burn</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].flag<sp/>==<sp/>2<sp/>&amp;&amp;<sp/></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>&lt;<sp/>(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t+configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters))){</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>second<sp/>burn<sp/>is<sp/>still<sp/>executed,<sp/>so<sp/>second<sp/>burn<sp/>attitude<sp/>is<sp/>set<sp/>as<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>==<sp/>2<sp/>&amp;&amp;<sp/></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>&lt;<sp/>(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t+configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters))){</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>first<sp/>burn<sp/>is<sp/>still<sp/>executed,<sp/>so<sp/>first<sp/>burn<sp/>attitude<sp/>is<sp/>set<sp/>as<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t_left<sp/>&gt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad6f1b0962df6f7541810df7fb7d698e8" kindref="member">attRefInIsLinked</ref>){</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>there<sp/>is<sp/>enough<sp/>time<sp/>until<sp/>second<sp/>burn,<sp/>so<sp/>reference<sp/>input<sp/>attitude<sp/>is<sp/>set<sp/>as<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*attRefOutMsgBuffer<sp/>=<sp/>attRefInMsgBuffer;</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>third<sp/>burn<sp/>attitude<sp/>is<sp/>set<sp/>at<sp/>target</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(t_left<sp/>&lt;<sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>==<sp/>1){</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i<sp/>=<sp/>0;i<sp/>&lt;<sp/>thrustConfigMsgBuffer.numThrusters;++i){</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>thrustOnMsgBuffer-&gt;OnTimeRequest[i]<sp/>=<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].thrustOnTime/thrustConfigMsgBuffer.numThrusters;</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>section<sp/>is<sp/>valid<sp/>when<sp/>all<sp/>the<sp/>impulses<sp/>are<sp/>finished</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>we<sp/>have<sp/>to<sp/>consider<sp/>a<sp/>case<sp/>when<sp/>one<sp/>dvArray[].flag<sp/>is<sp/>set<sp/>to<sp/>3,<sp/>which<sp/>means<sp/>that<sp/>the<sp/>burn<sp/>is<sp/>combined<sp/>with<sp/>another</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>==<sp/>2){</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>&gt;<sp/>(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t+configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters))<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad6f1b0962df6f7541810df7fb7d698e8" kindref="member">attRefInIsLinked</ref>){</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*attRefOutMsgBuffer<sp/>=<sp/>attRefInMsgBuffer;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].flag<sp/>==<sp/>2){</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>&gt;<sp/>(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t+configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters))<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad6f1b0962df6f7541810df7fb7d698e8" kindref="member">attRefInIsLinked</ref>){</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*attRefOutMsgBuffer<sp/>=<sp/>attRefInMsgBuffer;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/><sp/></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>==<sp/>2){</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>&gt;<sp/>(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t+configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime/(2*thrustConfigMsgBuffer.numThrusters))<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ad6f1b0962df6f7541810df7fb7d698e8" kindref="member">attRefInIsLinked</ref>){</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*attRefOutMsgBuffer<sp/>=<sp/>attRefInMsgBuffer;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Copy(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].sigma_RN,<sp/>attRefOutMsgBuffer-&gt;sigma_RN);</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*attRefOutMsgBuffer<sp/>=<sp/>attRefInMsgBuffer;</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1ac9861dee45232c0fb5095af51f4ec5dd" kindref="member">thrustOnFlag</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="271"><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>at<sp/>the<sp/>end<sp/>of<sp/>one<sp/>orbital<sp/>period,<sp/>reset<sp/>this<sp/>module</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a07864a359b44a99fef521771d465a5a8" kindref="member">tCurrent</ref><sp/>&gt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a4aa4f9c3e1a3361e19e58373c3e32dd1" kindref="member">resetPeriod</ref>){</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Reset_spacecraftReconfig(configData,<sp/>callTime,<sp/>moduleID);</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="278"><highlight class="normal">}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>AdjustRange(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lower,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>upper,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>angle)</highlight></codeline>
<codeline lineno="288"><highlight class="normal">{</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(upper<sp/>&lt;<sp/>lower){</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;illegal<sp/>parameters\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>width<sp/>=<sp/>upper<sp/>-<sp/>lower;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>adjusted_angle<sp/>=<sp/>angle;</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(adjusted_angle<sp/>&gt;<sp/>upper){</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>adjusted_angle<sp/>=<sp/>adjusted_angle<sp/>-<sp/>width;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(adjusted_angle<sp/>&lt;<sp/>lower){</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>adjusted_angle<sp/>=<sp/>adjusted_angle<sp/>+<sp/>width;</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>adjusted_angle;</highlight></codeline>
<codeline lineno="302"><highlight class="normal">}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>CompareTime(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<sp/>n1,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<sp/>n2)</highlight></codeline>
<codeline lineno="311"><highlight class="normal">{</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(((ReconfigBurnInfoMsgPayload*)n1)-&gt;t<sp/>&gt;<sp/>((ReconfigBurnInfoMsgPayload*)n2)-&gt;t)</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(((ReconfigBurnInfoMsgPayload*)n1)-&gt;t<sp/>&lt;<sp/>((ReconfigBurnInfoMsgPayload*)n2)-&gt;t)</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="324"><highlight class="normal">}</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>ScheduleDV(<ref refid="structspacecraft_reconfig_config" kindref="compound">spacecraftReconfigConfig</ref><sp/>*configData,classicElements<sp/>oe_c,</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classicElements<sp/>oe_d,<sp/>THRArrayConfigMsgPayload<sp/>thrustConfigMsgBuffer,<sp/>VehicleConfigMsgPayload<sp/>vehicleConfigMsgBuffer)</highlight></codeline>
<codeline lineno="337"><highlight class="normal">{</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculation<sp/>necessary<sp/>variables</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>da<sp/><sp/><sp/><sp/><sp/>=<sp/>oe_d.a<sp/>-<sp/>oe_c.a;</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>de<sp/><sp/><sp/><sp/><sp/>=<sp/>oe_d.e<sp/>-<sp/>oe_c.e;</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>di<sp/><sp/><sp/><sp/><sp/>=<sp/>oe_d.i<sp/>-<sp/>oe_c.i;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/>di<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(-M_PI,<sp/>M_PI,<sp/>di);</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>domega<sp/>=<sp/>oe_d.omega<sp/>-<sp/>oe_c.omega;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dOmega<sp/>=<sp/>oe_d.Omega<sp/>-<sp/>oe_c.Omega;</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/>dOmega<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(-M_PI,<sp/>M_PI,<sp/>dOmega);</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/>domega<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(-M_PI,<sp/>M_PI,<sp/>domega);</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>E_c<sp/><sp/><sp/><sp/>=<sp/>f2E(oe_c.f,<sp/>oe_c.e);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>M_c<sp/><sp/><sp/><sp/>=<sp/>E2M(E_c,<sp/>oe_c.e);</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/>M_c<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(0,<sp/>2*M_PI,<sp/>M_c);</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>E_d<sp/><sp/><sp/><sp/>=<sp/>f2E(oe_d.f,<sp/>oe_d.e);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>M_d<sp/><sp/><sp/><sp/>=<sp/>E2M(E_d,<sp/>oe_d.e);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/>M_d<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(0,<sp/>2*M_PI,<sp/>M_d);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dM<sp/><sp/><sp/><sp/><sp/>=<sp/>M_d<sp/>-<sp/>M_c;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/>dM<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(-M_PI,<sp/>M_PI,<sp/>dM);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>n<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sqrt(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6bd3b7f95e733f588a9019ed411e050a" kindref="member">mu</ref>/(oe_c.a*oe_c.a*oe_c.a));</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eta<sp/><sp/><sp/><sp/>=<sp/>sqrt(1.0-oe_c.e*oe_c.e);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>p<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>oe_c.a*(1.0-oe_c.e*oe_c.e);</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>h<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>n*oe_c.a*oe_c.a*eta;</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rp<sp/><sp/><sp/><sp/><sp/>=<sp/>oe_c.a*(1.0-oe_c.e);</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ra<sp/><sp/><sp/><sp/><sp/>=<sp/>oe_c.a*(1.0+oe_c.e);</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>da<sp/><sp/><sp/><sp/><sp/>=<sp/>da<sp/><sp/><sp/><sp/><sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6e724aaf2085431c5a63ddee478c5719" kindref="member">targetClassicOED</ref>[0];</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>di<sp/><sp/><sp/><sp/><sp/>=<sp/>di<sp/><sp/><sp/><sp/><sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6e724aaf2085431c5a63ddee478c5719" kindref="member">targetClassicOED</ref>[2];</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>de<sp/><sp/><sp/><sp/><sp/>=<sp/>de<sp/><sp/><sp/><sp/><sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6e724aaf2085431c5a63ddee478c5719" kindref="member">targetClassicOED</ref>[1];</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/>dOmega<sp/>=<sp/>dOmega<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6e724aaf2085431c5a63ddee478c5719" kindref="member">targetClassicOED</ref>[3];</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>domega<sp/>=<sp/>domega<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6e724aaf2085431c5a63ddee478c5719" kindref="member">targetClassicOED</ref>[4];</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/>dM<sp/><sp/><sp/><sp/><sp/>=<sp/>dM<sp/><sp/><sp/><sp/><sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6e724aaf2085431c5a63ddee478c5719" kindref="member">targetClassicOED</ref>[5];</highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>calculation<sp/>below<sp/>is<sp/>divided<sp/>into<sp/>two<sp/>parts<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>1.<sp/>calculate<sp/>dV<sp/>maneuver<sp/>timing<sp/>in<sp/>tangential<sp/>and<sp/>radial<sp/>direction<sp/>at<sp/>perigee<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>2.<sp/>calculate<sp/>dV<sp/>maneuver<sp/>timing<sp/>in<sp/>tangential<sp/>and<sp/>radial<sp/>direction<sp/>at<sp/>apogee<sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>3.<sp/>calculate<sp/>dV<sp/>maneuver<sp/>timing<sp/>in<sp/>normal<sp/>direction<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>4.<sp/>calculate<sp/>dV<sp/>magnitude<sp/>for<sp/>each<sp/>burn<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>5.<sp/>calculate<sp/>thrustOnTime<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>1.<sp/>calculate<sp/>t_dvrtp</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_c_dvrtp<sp/>=<sp/>0.0;<sp/></highlight><highlight class="comment">//<sp/>f<sp/>=<sp/>0<sp/>@<sp/>perigee</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>E_c_dvrtp<sp/>=<sp/>f2E(f_c_dvrtp,<sp/>oe_c.e);</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>M_c_dvrtp<sp/>=<sp/>E2M(E_c_dvrtp,<sp/>oe_c.e);</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/>M_c_dvrtp<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(0,<sp/>2*M_PI,<sp/>M_c_dvrtp);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(M_c_dvrtp<sp/>&gt;<sp/>M_c){</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>=<sp/>(M_c_dvrtp<sp/>-<sp/>M_c)/n;</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>=<sp/>(2*M_PI<sp/>+<sp/>M_c_dvrtp<sp/>-<sp/>M_c)/n;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>2.<sp/>calculate<sp/>t_dvrta</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_c_dvrta<sp/>=<sp/>M_PI;<sp/></highlight><highlight class="comment">//<sp/>f<sp/>=<sp/>pi<sp/>@<sp/>apogee</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>E_c_dvrta<sp/>=<sp/>f2E(f_c_dvrta,<sp/>oe_c.e);</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>M_c_dvrta<sp/>=<sp/>E2M(E_c_dvrta,<sp/>oe_c.e);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/>M_c_dvrta<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(0,<sp/>2*M_PI,<sp/>M_c_dvrta);</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(M_c_dvrta<sp/>&gt;<sp/>M_c){</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>=<sp/>(M_c_dvrta<sp/>-<sp/>M_c)/n;</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>=<sp/>(2*M_PI<sp/>+<sp/>M_c_dvrta<sp/>-<sp/>M_c)/n;</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>3.<sp/>calculate<sp/>t_dvn</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>theta_c<sp/><sp/><sp/><sp/><sp/>=<sp/>oe_c.omega<sp/>+<sp/>oe_c.f;</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/>theta_c<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(0,<sp/>2*M_PI,<sp/>theta_c);</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>theta_c_dvn<sp/>=<sp/>atan2((-dOmega)*sin(oe_c.i),<sp/>(-di));</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>choose<sp/>burn<sp/>lattitude<sp/>angle<sp/>so<sp/>that<sp/>dV<sp/>is<sp/>+z<sp/>direction<sp/>in<sp/>LVLH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">((-di)*cos(theta_c_dvn)&lt;0<sp/>&amp;&amp;<sp/>(-dOmega)*sin(oe_c.i)*sin(theta_c_dvn)<sp/>&lt;0){</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>theta_c_dvn<sp/>=<sp/>theta_c_dvn<sp/>+<sp/>M_PI;</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/>theta_c_dvn<sp/><sp/><sp/><sp/>=<sp/>AdjustRange(0,<sp/>2*M_PI,<sp/>theta_c_dvn);</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_c_dvn<sp/>=<sp/>theta_c_dvn<sp/>-<sp/>oe_c.omega;</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>E_c_dvn<sp/>=<sp/>f2E(f_c_dvn,<sp/>oe_c.e);</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>M_c_dvn<sp/>=<sp/>E2M(E_c_dvn,<sp/>oe_c.e);</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>M_c_dvn<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AdjustRange(0,<sp/>2*M_PI,<sp/>M_c_dvn);</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(M_c_dvn<sp/>&gt;<sp/>M_c){</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>=<sp/>(M_c_dvn<sp/>-<sp/>M_c)/n;</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>=<sp/>(2*M_PI<sp/>+<sp/>M_c_dvn<sp/>-<sp/>M_c)/n;</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>4.<sp/>calculate<sp/>dvrp_mag,<sp/>dvtp_mag,<sp/>dvra_mag,<sp/>dvta_mag,<sp/>dvn_mag</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dvtp_mag<sp/>=<sp/>n*oe_c.a*eta/4.0*((-da)/oe_c.a<sp/>+<sp/>(-de)/(1.0+oe_c.e));</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dvta_mag<sp/>=<sp/>n*oe_c.a*eta/4.0*((-da)/oe_c.a<sp/>-<sp/>(-de)/(1.0-oe_c.e));</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>compensate<sp/>drift<sp/>of<sp/>dM<sp/>caused<sp/>by<sp/>initial<sp/>da</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t){</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dM<sp/>=<sp/>dM</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>3.0/2.0*n/oe_c.a*da*configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>3.0/2.0*n/oe_c.a*(da+2.0*oe_c.a*oe_c.a/h*p/rp*dvtp_mag)*(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t);</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dM<sp/>=<sp/>dM</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>3.0/2.0*n/oe_c.a*da*configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>3.0/2.0*n/oe_c.a*(da+2.0*oe_c.a*oe_c.a/h*p/ra*dvta_mag)*(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t);</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dvrp_mag<sp/>=<sp/>-n*oe_c.a/4*(pow(1+oe_c.e,2)/eta*((-domega)+(-dOmega)*cos(oe_c.i))<sp/>+<sp/>(-dM));</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dvra_mag<sp/>=<sp/>-n*oe_c.a/4*(pow(1-oe_c.e,2)/eta*((-domega)+(-dOmega)*cos(oe_c.i))<sp/>+<sp/>(-dM));</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>r_dvn<sp/>=<sp/>p/(1+oe_c.e*cos(f_c_dvn));</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dvn_mag<sp/>=<sp/>h/r_dvn*sqrt(pow((-di),2)<sp/>+<sp/>pow((-dOmega)*sin(oe_c.i),2));</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>5.<sp/>calculate<sp/>thrustOnTime</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>timings<sp/>of<sp/>any<sp/>two<sp/>burns<sp/>are<sp/>close<sp/>to<sp/>each<sp/>other,<sp/>they<sp/>are<sp/>combined<sp/>into<sp/>one<sp/>burn</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref>){</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime<sp/>=<sp/>sqrt(dvrp_mag*dvrp_mag+dvtp_mag*dvtp_mag+dvn_mag*dvn_mag)*<sp/>vehicleConfigMsgBuffer.massSC/thrustConfigMsgBuffer.thrusters[0].maxThrust;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].thrustOnTime<sp/>=<sp/>sqrt(dvra_mag*dvra_mag+dvta_mag*dvta_mag)*<sp/>vehicleConfigMsgBuffer.massSC/thrustConfigMsgBuffer.thrusters[0].maxThrust;</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].thrustOnTime<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>=<sp/>3;</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref>){</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime<sp/>=<sp/>sqrt(dvrp_mag*dvrp_mag+dvtp_mag*dvtp_mag)*<sp/>vehicleConfigMsgBuffer.massSC/thrustConfigMsgBuffer.thrusters[0].maxThrust;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].thrustOnTime<sp/>=<sp/>sqrt(dvra_mag*dvra_mag+dvta_mag*dvta_mag+dvn_mag*dvn_mag)*<sp/>vehicleConfigMsgBuffer.massSC/thrustConfigMsgBuffer.thrusters[0].maxThrust;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].thrustOnTime<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>=<sp/>3;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime<sp/>=<sp/>sqrt(dvrp_mag*dvrp_mag+dvtp_mag*dvtp_mag)*<sp/>vehicleConfigMsgBuffer.massSC/thrustConfigMsgBuffer.thrusters[0].maxThrust;</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].thrustOnTime<sp/>=<sp/>sqrt(dvra_mag*dvra_mag+dvta_mag*dvta_mag)*<sp/>vehicleConfigMsgBuffer.massSC/thrustConfigMsgBuffer.thrusters[0].maxThrust;</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].thrustOnTime<sp/>=<sp/>dvn_mag*<sp/>vehicleConfigMsgBuffer.massSC/thrustConfigMsgBuffer.thrusters[0].maxThrust;</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>thrustOnTime<sp/>is<sp/>smaller<sp/>than<sp/>a<sp/>cerain<sp/>threshold,<sp/>the<sp/>impulse<sp/>is<sp/>neglected</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>1.0<sp/>second<sp/>is<sp/>temporarily<sp/>set<sp/>as<sp/>threshold<sp/>regarding<sp/>whether<sp/>small<sp/>impulse<sp/>is<sp/>neglected<sp/>or<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].thrustOnTime/thrustConfigMsgBuffer.numThrusters<sp/>&lt;<sp/>1.0){</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>=<sp/>3;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].thrustOnTime/thrustConfigMsgBuffer.numThrusters<sp/>&lt;<sp/>1.0){</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].flag<sp/>=<sp/>3;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].thrustOnTime/thrustConfigMsgBuffer.numThrusters<sp/>&lt;<sp/>1.0){</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>=<sp/>3;</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>below<sp/>is<sp/>calculation<sp/>of<sp/>target<sp/>sigma<sp/>for<sp/>three<sp/>burns<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>R<sp/>frame<sp/>represents<sp/>a<sp/>frame<sp/>where<sp/>scheduled<sp/>thrusct<sp/>direction<sp/>is<sp/>aligned<sp/>with<sp/>+Z<sp/>axis<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>dcm_TR<sp/>is<sp/>used<sp/>to<sp/>align<sp/>scheduled<sp/>thrust<sp/>direction<sp/>with<sp/>configured<sp/>thruster<sp/>direction<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>by<sp/>multiplying<sp/>two<sp/>dcms<sp/>dcm_TR<sp/>and<sp/>dcm_RN,<sp/>target<sp/>attitude<sp/>is<sp/>calculated<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>calculate<sp/>dcm_TR<sp/>(this<sp/>is<sp/>common<sp/>in<sp/>three<sp/>burns)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>thruster_dir[3];</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ep_vec[3];</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ez[3]<sp/>=<sp/>{0.0,0.0,1.0};</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(thrustConfigMsgBuffer.thrusters[0].tHatThrust_B,thruster_dir);</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(thruster_dir[0]<sp/>==<sp/>0.0<sp/>&amp;&amp;<sp/>thruster_dir[1]<sp/>==<sp/>0.0){</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>can<sp/>be<sp/>any<sp/>vector<sp/>in<sp/>XY-plane</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ep_vec[0]<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ep_vec[1]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ep_vec[2]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Cross(thruster_dir,ez,ep_vec);</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(ep_vec,ep_vec);</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>cos_dv<sp/>=<sp/>v3Dot(thruster_dir,ez);</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>acos_dv<sp/>=<sp/>safeAcos(cos_dv);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ep_TR[4]<sp/>=<sp/>{cos(acos_dv/2.0),ep_vec[0]*sin(acos_dv/2.0),ep_vec[1]*sin(acos_dv/2.0),ep_vec[2]*sin(acos_dv/2.0)};</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dcm_TR[3][3];</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/>EP2C(ep_TR,dcm_TR);</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>calculate<sp/>sigma_dvrtp_RN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>dcm_RN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>M_d_dvrtp<sp/>=<sp/>M_d<sp/>+<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t*n;</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>E_d_dvrtp<sp/>=<sp/>M2E(M_d_dvrtp,<sp/>oe_d.e);</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_d_dvrtp<sp/>=<sp/>E2f(E_d_dvrtp,<sp/>oe_d.e);</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/>classicElements<sp/>oe_d_dvrtp;</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>oe_d_dvrtp<sp/><sp/><sp/>=<sp/>oe_d;</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/>oe_d_dvrtp.f<sp/>=<sp/>f_d_dvrtp;</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rVec_d_dvrtp[3],<sp/>vVec_d_dvrtp[3],<sp/>hVec_d_dvrtp[3],tVec_d_dvrtp[3];</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/>elem2rv(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6bd3b7f95e733f588a9019ed411e050a" kindref="member">mu</ref>,<sp/>&amp;oe_d_dvrtp,<sp/>rVec_d_dvrtp,<sp/>vVec_d_dvrtp);</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Cross(rVec_d_dvrtp,<sp/>vVec_d_dvrtp,<sp/>hVec_d_dvrtp);</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Cross(hVec_d_dvrtp,<sp/>rVec_d_dvrtp,<sp/>tVec_d_dvrtp);</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(rVec_d_dvrtp,rVec_d_dvrtp);</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Scale(dvrp_mag,rVec_d_dvrtp,rVec_d_dvrtp);</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(tVec_d_dvrtp,tVec_d_dvrtp);</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Scale(dvtp_mag,tVec_d_dvrtp,tVec_d_dvrtp);</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>thrustVec_dvrtp[3];</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>sum<sp/>of<sp/>scalalized<sp/>two<sp/>vectors<sp/>in<sp/>tangential<sp/>and<sp/>radial<sp/>directions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Add(rVec_d_dvrtp,tVec_d_dvrtp,thrustVec_dvrtp);</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>case<sp/>two<sp/>burns<sp/>are<sp/>combined,<sp/>target<sp/>attitude<sp/>also<sp/>has<sp/>to<sp/>be<sp/>adjusted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref>){</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Normalize(hVec_d_dvrtp,hVec_d_dvrtp);</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Scale(dvn_mag,hVec_d_dvrtp,hVec_d_dvrtp);</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>normal<sp/>direction<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Add(thrustVec_dvrtp,hVec_d_dvrtp,thrustVec_dvrtp);</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Cross(thrustVec_dvrtp,<sp/>hVec_d_dvrtp,<sp/>hVec_d_dvrtp);</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dcm_RN_dvrtp[3][3];</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(thrustVec_dvrtp,<sp/>dcm_RN_dvrtp[2]);</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(hVec_d_dvrtp,<sp/>dcm_RN_dvrtp[1]);</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Cross(dcm_RN_dvrtp[1],<sp/>dcm_RN_dvrtp[2],<sp/>dcm_RN_dvrtp[0]);</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>dcm_TN<sp/>=<sp/>dcm_TR<sp/>*<sp/>dcm_RN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dcm_TN_dvrtp[3][3];</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/>m33MultM33(dcm_TR,dcm_RN_dvrtp,dcm_TN_dvrtp);</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/>C2MRP(dcm_TN_dvrtp,<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].sigma_RN);</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>calculate<sp/>sigma_dvrta_RN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>M_d_dvrta<sp/>=<sp/>M_d<sp/>+<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t*n;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>E_d_dvrta<sp/>=<sp/>M2E(M_d_dvrta,<sp/>oe_d.e);</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_d_dvrta<sp/>=<sp/>E2f(E_d_dvrta,<sp/>oe_d.e);</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/>classicElements<sp/>oe_d_dvrta;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/>oe_d_dvrta<sp/><sp/><sp/>=<sp/>oe_d;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/>oe_d_dvrta.f<sp/>=<sp/>f_d_dvrta;</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rVec_d_dvrta[3],<sp/>vVec_d_dvrta[3],<sp/>hVec_d_dvrta[3],tVec_d_dvrta[3];</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/>elem2rv(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6bd3b7f95e733f588a9019ed411e050a" kindref="member">mu</ref>,<sp/>&amp;oe_d_dvrta,<sp/>rVec_d_dvrta,<sp/>vVec_d_dvrta);</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Cross(rVec_d_dvrta,<sp/>vVec_d_dvrta,<sp/>hVec_d_dvrta);</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Cross(hVec_d_dvrta,<sp/>rVec_d_dvrta,<sp/>tVec_d_dvrta);</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(rVec_d_dvrta,rVec_d_dvrta);</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Scale(dvra_mag,rVec_d_dvrta,rVec_d_dvrta);</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(tVec_d_dvrta,tVec_d_dvrta);</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Scale(dvta_mag,tVec_d_dvrta,tVec_d_dvrta);</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>thrustVec_dvrta[3];</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>sum<sp/>of<sp/>scalalized<sp/>two<sp/>vectors<sp/>in<sp/>tangential<sp/>and<sp/>radial<sp/>directions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Add(rVec_d_dvrta,tVec_d_dvrta,thrustVec_dvrta);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>case<sp/>two<sp/>burns<sp/>are<sp/>combined,<sp/>target<sp/>attitude<sp/>also<sp/>has<sp/>to<sp/>be<sp/>adjusted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref>){</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Normalize(hVec_d_dvrta,hVec_d_dvrta);</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Scale(dvn_mag,hVec_d_dvrta,hVec_d_dvrta);</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>add<sp/>normal<sp/>direction<sp/>vector</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Add(thrustVec_dvrta,hVec_d_dvrta,thrustVec_dvrta);</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v3Cross(thrustVec_dvrta,<sp/>hVec_d_dvrta,<sp/>hVec_d_dvrta);</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dcm_RN_dvrta[3][3];</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(thrustVec_dvrta,<sp/>dcm_RN_dvrta[2]);</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(hVec_d_dvrta,<sp/>dcm_RN_dvrta[1]);</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Cross(dcm_RN_dvrta[1],<sp/>dcm_RN_dvrta[2],<sp/>dcm_RN_dvrta[0]);</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>dcm_TN<sp/>=<sp/>dcm_TR<sp/>*<sp/>dcm_RN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dcm_TN_dvrta[3][3];</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/>m33MultM33(dcm_TR,dcm_RN_dvrta,dcm_TN_dvrta);</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/>C2MRP(dcm_TN_dvrta,<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].sigma_RN);</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>calculate<sp/>sigma_dvn_RN<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>M_d_dvn<sp/>=<sp/>M_d<sp/>+<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t*n;</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>E_d_dvn<sp/>=<sp/>M2E(M_d_dvn,<sp/>oe_d.e);</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_d_dvn<sp/>=<sp/>E2f(E_d_dvn,<sp/>oe_d.e);</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/>classicElements<sp/>oe_d_dvn;</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/>oe_d_dvn<sp/>=<sp/>oe_d;</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/>oe_d_dvn.f<sp/>=<sp/>f_d_dvn;</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>rVec_d_dvn[3],<sp/>vVec_d_dvn[3],<sp/>hVec_d_dvn[3];</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dcm_RN[3][3];</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/>elem2rv(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a6bd3b7f95e733f588a9019ed411e050a" kindref="member">mu</ref>,<sp/>&amp;oe_d_dvn,<sp/>rVec_d_dvn,<sp/>vVec_d_dvn);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(rVec_d_dvn,<sp/>dcm_RN[0]);</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Cross(rVec_d_dvn,<sp/>vVec_d_dvn,<sp/>hVec_d_dvn);</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>normal<sp/>direction<sp/>is<sp/>thrust<sp/>direction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Normalize(hVec_d_dvn,<sp/>dcm_RN[2]);</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/>v3Cross(dcm_RN[2],<sp/>dcm_RN[0],<sp/>dcm_RN[1]);</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref>){</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C2MRP(dcm_TN_dvrtp,<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].sigma_RN);</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].t<sp/>-<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].t<sp/>&lt;<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1aa63ba2b993387d22f73a6b3da8d5efd0" kindref="member">attControlTime</ref>){</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C2MRP(dcm_TN_dvrta,<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].sigma_RN);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight><highlight class="keywordflow">else</highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>dcm_TN<sp/>=<sp/>dcm_TR<sp/>*<sp/>dcm_RN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>dcm_TN_dvn[3][3];</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m33MultM33(dcm_TR,dcm_RN,dcm_TN_dvn);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>C2MRP(dcm_TN_dvn,<sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].sigma_RN);</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="587"><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>if<sp/>each<sp/>dV<sp/>is<sp/>scheduled<sp/>(and<sp/>not<sp/>skipped),<sp/>then<sp/>set<sp/>flag<sp/>to<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[0].flag<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].flag<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[1].flag<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>==<sp/>0){</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>configData-&gt;<ref refid="structspacecraft_reconfig_config_1a51f84ad7a9e483106051d8193d58501c" kindref="member">burnArrayInfoOutMsgBuffer</ref>.burnArray[2].flag<sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="598"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/Users/julio/Desktop/basilisk/src/fswAlgorithms/formationFlying/spacecraftReconfig/spacecraftReconfig.c"/>
  </compounddef>
</doxygen>
